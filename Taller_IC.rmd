---
  title: "Taller de Intervalos de Confianza"
output:
  html_document:
  df_print: paged
pdf_document: default
---
  
  # Estadistica
  ### Febrero de 2020
  #### Andrés Felipe Florián e Isabella Martínez
  
  ## Introducción 
  
  Se utilizará un dataset de 5000 imágenes histopatológicasde pacientes con cáncer colorrectal a escala de grises de 64 píxeles.

```{r}
data_set = read.csv("hmnist_28_28_L.csv", header = TRUE, encoding = "UTF-8", sep = ",") #784
```

## Punto 1

### a)

Se puede calcular el píxel de la mitad de una imágen de $n \times n$ píxeles, dado $n$ par mediante la siguiente fórmula: $$  \frac{n(n-1)}{2}. $$ Así pues, el píxel de la mitad en una imágen $28 \times 28$ es el 378. Note el resumen estadístico del mismo:
  
```{r}
pixel_central <- data_set$pixel0378
summary(pixel_central)

```

Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pixel_central, main = "Histograma del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pixel_central, col = "Red")
```

###b)

Ahora consideramos los tejidos con cáncer, es decir, aquellos cuyo label es igual a 1.

```{r}
pc_cancer = data_set$pixel0378[data_set$label == 1]
summary(pc_cancer)
```

Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_cancer, main = "Histograma de los Tejidos con Cancer del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_cancer, col = "Red")
```

###c)

Ahora consideramos los tejidos que no tienen cáncer, es decir, aquellos cuyo label no es igual a 1.

```{r}
pc_no_cancer = data_set$pixel0378[data_set$label != 1]
summary(pc_no_cancer)
```

Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_no_cancer, main = "Histograma de los Tejidos con Cancer del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_no_cancer, col = "Red")
```


###d)

Para los que son STROMA: 
  
```{r}
pc_stroma = data_set$pixel0378[data_set$label == 2]
summary(pc_stroma)
```


Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_stroma, main = "Histograma de los Tejidos Stroma Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_stroma, col = "Red")
```

Para los que son COMPLEX:
```{r}
pc_complex = data_set$pixel0378[data_set$label == 3]
summary(pc_complex)
```


Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_complex, main = "Histograma de los Tejidos Complex del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_complex, col = "Red")
```

Para los que son LYMPHO:
```{r}
pc_lympho = data_set$pixel0378[data_set$label == 4]
summary(pc_lympho)
```


Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_lympho, main = "Histograma de los Tejidos Lympho del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_lympho, col = "Red")
```

Para los que son DEBRIS:
  
```{r}
pc_debris = data_set$pixel0378[data_set$label == 5]
summary(pc_debris)
```


Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_debris, main = "Histograma de los Tejidos Debris del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_debris, col = "Red")
```

Para los que son MUCOSA:
  
```{r}
pc_mucosa = data_set$pixel0378[data_set$label == 6]
summary(pc_mucosa)
```


Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_mucosa, main = "Histograma de los Tejidos Mucosa del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_mucosa, col = "Red")
```

Para los que son ADIPOSE:
  
```{r}
pc_adipose = data_set$pixel0378[data_set$label == 7]
summary(pc_adipose)
```


Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_adipose, main = "Histograma de los Tejidos Adipose del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_adipose, col = "Red")
```

Para los que son EMPTY:
  
```{r}
pc_empty = data_set$pixel0378[data_set$label == 8]
summary(pc_empty)
```


Considere además su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del píxel en codificación de 8 bits. En el diagrama de caja también se ven los valores atípicos del mismo.

```{r}
hist(pc_empty, main = "Histograma de los Tejidos Empty del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_empty, col = "Red")
```

##Punto 2.

```{r}
intento = matrix(unlist(data_set[1,1:784]),byrow = FALSE, nrow=28)
image(intento)
image(intento, col=gray.colors(64))
```

Con cada uno de los tipos:

```{r}

```





#Punto 3.

Intervalo de confianza del 95% para la media del pixel central.

Tenemos que 1 $1- \alpha = 0.95$, luego $\frac{\alpha}{2} = 0.025$. Como es una muestra grande se aproxima a una normal. 

##a). 

Para los tejidos con tumor, es decir para los cuales su label es igual a 1.

```{r}

media = mean(pixel_central[data_set$label == 1])
n = length(pixel_central)
s = sd(pixel_central)
z = qnorm(0.025, lower.tail = FALSE)
lim.inf <- media - z*(s/n)
lim.sup <- media + z*(s/n)
print("IC:")
d <- c(lim.inf , lim.sup)
d


```
##b).

Para los tejidos que no son tumor.

```{r}
media = mean(pixel_central[data_set$label != 1])
n = length(pixel_central)
s = sd(pixel_central)
z = qnorm(0.025, lower.tail = FALSE)
lim.inf <- media - z*(s/n)
lim.sup <- media + z*(s/n)
print("IC:")
d <- c(lim.inf , lim.sup)
d

```
##c).

Para los tipos restantes de tejidos.

```{r}

tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 2:8){
  media = mean(pixel_central[data_set$label == i])
  n = length(pixel_central)
  s = sd(pixel_central)
  z = qnorm(0.025, lower.tail = FALSE)
  lim.inf <- media - z*(s/n)
  lim.sup <- media + z*(s/n)
  print(tejidos[i-1])
  d <- c(lim.inf , lim.sup)
  print(d)
}


```
#Punto 4.

##a).

Se tomará una muestra de 200 pixeles aleatoriamente.

```{r}
muestra <- sample(data_set, 200)

muestra
```



Para una muestra de 200 pixeles. Tejido sin tumor.

```{r}
medias <-c(rep(0,200))
for(i in 1:200){
  x <- muestra[1:5000,i][data_set$label == 1]
  medias[i] = mean(x)
}


media <- mean(medias)
n = 200
s = sd(medias)
z = qnorm(0.025, lower.tail = FALSE)
lim.inf <- media - z*(s/n)
lim.sup <- media + z*(s/n)
IC <- c(lim.inf,lim.sup)
print("IC: ")
IC
```


Para los tejidos que no son tumor.

```{r}
medias <-c(rep(0,200))
for(i in 1:200){
  x <- muestra[1:5000,i][data_set$label != 1]
  medias[i] = mean(x)
}


media <- mean(medias)
n = 200
s = sd(medias)
z = qnorm(0.025, lower.tail = FALSE)
lim.inf <- media - z*(s/n)
lim.sup <- media + z*(s/n)
IC <- c(lim.inf,lim.sup)
print("IC: ")
IC
```

Para el resto de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
medias <-c(rep(0,200))
d <- c(rep(0,7))
e <- c(rep(0,7))
for(i in 2:8){
  for(j in 1:200){
    x <- muestra[1:5000,i][data_set$label == i]
    medias[i] = mean(x)
  }
  d[i-1] = mean(medias)
  e[i-1] = sd(medias)
    
}

for(i in 1:length(d)){
  media = d[i]
  n = 200
  s = e[i]
  z = qnorm(0.025, lower.tail = FALSE)
  lim.inf <- media - z*(s/n)
  lim.sup <- media + z*(s/n)
  print(tejidos[i])
  f <- c(lim.inf , lim.sup)
  print(f)
}



```

##b).

Se tomará una muestra de 20 pixeles aleatoriamente.

```{r}
muestra <- sample(data_set, 20)

muestra
```



Para una muestra de 200 pixeles. Tejido sin tumor.
```{r}
medias <-c(rep(0,20))
for(i in 1:20){
  x <- muestra[1:5000,i][data_set$label == 1]
  medias[i] = mean(x)
}


media <- mean(medias)
n = 20
s = sd(medias)
z = qnorm(0.025, lower.tail = FALSE)
lim.inf <- media - z*(s/n)
lim.sup <- media + z*(s/n)
IC <- c(lim.inf,lim.sup)
print("IC: ")
IC
```
Para los tejidos que no son tumor.
```{r}
medias <-c(rep(0,20))
for(i in 1:20){
  x <- muestra[1:5000,i][data_set$label != 1]
  medias[i] = mean(x)
}


media <- mean(medias)
n = 20
s = sd(medias)
z = qnorm(0.025, lower.tail = FALSE)
lim.inf <- media - z*(s/n)
lim.sup <- media + z*(s/n)
IC <- c(lim.inf,lim.sup)
print("IC: ")
IC
```

Para el resto de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
medias <-c(rep(0,20))
d <- c(rep(0,7))
e <- c(rep(0,7))
for(i in 2:8){
  for(j in 1:200){
    x <- muestra[1:5000,i][data_set$label == i]
    medias[i] = mean(x)
  }
  d[i-1] = mean(medias)
  e[i-1] = sd(medias)
    
}

for(i in 1:length(d)){
  media = d[i]
  n = 20
  s = e[i]
  z = qnorm(0.025, lower.tail = FALSE)
  lim.inf <- media - z*(s/n)
  lim.sup <- media + z*(s/n)
  print(tejidos[i])
  f <- c(lim.inf , lim.sup)
  print(f)
}



```

##c).

```{r}

medias <- c(rep(0,200))
lim.infs <- c(rep(0,100))
lim.sups <- c(rep(0,200))
x <-c(rep(0,100))

for(i in 1:100){
  muestra <- sample(data_set, 200)
  medias <-c(rep(0,200))
  for(i in 1:200){
    x <- muestra[1:5000,i][data_set$label == 1]
    medias[i] = mean(x)
  }
  media <- mean(medias)
  x[i] <- media
  print(x[i])
  n = 200
  s = sd(medias)
  z = qnorm(0.025, lower.tail = FALSE)
  inf <- media - z*(s/n)
  sup <- media + z*(s/n)
  lim.infs[i] = inf
  lim.sups[i] = sup
}

print(datos)
hist(datos,breaks= 2)

a = mean(datos)
b = sd(datos)
c = b/sqrt(100)

#curve(dnorm(x, mean=mean(datos), sd=sd(datos)))
#curve(dnorm(x, mean = a, sd = b, log = FALSE))

# Gráfica de la región del intervalo
#cord.x=c(IC[1],seq(IC[1],IC[2],0.01),IC[2])
#cord.y=c(0,dnorm(seq(IC[1],IC[2],0.01),mean=xbar,sd=SE),0)
#polygon(lim.infs,lim.sups,col="skyblue")
#abline(h=0)


```



--