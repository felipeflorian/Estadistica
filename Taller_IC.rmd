---
  title: "Taller de Intervalos de Confianza"
output:
  html_document:
  df_print: paged
pdf_document: default
---
  
  # Estadistica
  ### Febrero de 2020
  #### Andr√©s Felipe Flori√°n e Isabella Mart√≠nez
  
  ## Introducci√≥n 
  
  Se utilizar√° un dataset de 5000 im√°genes histopatol√≥gicasde pacientes con c√°ncer colorrectal a escala de grises de 64 p√≠xeles.

```{r}
data_set = read.csv("hmnist_28_28_L.csv", header = TRUE, encoding = "UTF-8", sep = ",") #784
```

## Punto 1

### a)

Se puede calcular el p√≠xel de la mitad de una im√°gen de $n \times n$ p√≠xeles, dado $n$ par mediante la siguiente f√≥rmula: $$  \frac{n(n-1)}{2}. $$ As√≠ pues, el p√≠xel de la mitad en una im√°gen $28 \times 28$ es el 378. Note el resumen estad√≠stico del mismo:
  
```{r}
pixel_central <- data_set$pixel0378
summary(pixel_central)

```

Considere adem√°s su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del p√≠xel en codificaci√≥n de 8 bits. En el diagrama de caja tambi√©n se ven los valores at√≠picos del mismo.

```{r}
hist(pixel_central, main = "Histograma del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pixel_central, col = "Red")
```

###b)

Ahora consideramos los tejidos con c√°ncer, es decir, aquellos cuyo label es igual a 1.

```{r}
pc_cancer = data_set$pixel0378[data_set$label == 1]
summary(pc_cancer)
```

Considere adem√°s su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del p√≠xel en codificaci√≥n de 8 bits. En el diagrama de caja tambi√©n se ven los valores at√≠picos del mismo.

```{r}
hist(pc_cancer, main = "Histograma de los Tejidos con Cancer del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_cancer, col = "Red")
```

###c)

Ahora consideramos los tejidos que no tienen c√°ncer, es decir, aquellos cuyo label no es igual a 1.

```{r}
pc_no_cancer = data_set$pixel0378[data_set$label != 1]
summary(pc_no_cancer)
```

Considere adem√°s su histograma y su diagrama de caja, para ver las frecuencias de las intensidades del p√≠xel en codificaci√≥n de 8 bits. En el diagrama de caja tambi√©n se ven los valores at√≠picos del mismo.

```{r}
hist(pc_no_cancer, main = "Histograma de los Tejidos con Cancer del Pixel Central", xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_no_cancer, col = "Red")
```


###d)

Consideremos ahora al resto de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 2:8){
  pc_i = data_set$pixel0378[data_set$label == i]
  summary(pc_i)
  hist(pc_i, main = paste("Histograma de los tejidos ", tejidos[i-1], " en su pixel central"), xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
boxplot(pc_i, col = "Red")
  
}
```


##Punto 2.

Vamos a graficar una imagen de cada tipo.
```{r}
tejidos_t = c("Tumor", "Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 1:8){
  choices = subset(data_set, label == i)
  matriz = matrix(unlist(choices[1,1:784]), byrow = FALSE, nrow = 28)
  image(matriz, col=gray.colors(64), main = paste("Imagen de tipo ", tejidos_t[i]))
}
```

#Punto 3.

Intervalo de confianza del 95% para la media del pixel central.

Tenemos que 1 $1- \alpha = 0.95$, luego $\frac{\alpha}{2} = 0.025$. Como es una muestra grande se aproxima a una normal. 

##a). 

Para los tejidos con tumor, es decir para los cuales su label es igual a 1.

```{r}
media = mean(pixel_central[data_set$label == 1], na.rm = TRUE)
n = length(pixel_central)
s = sd(pixel_central, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- media - z*(s/n)
lim_sup <- media + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
```
##b).

Para los tejidos que no son tumor.

```{r}
media = mean(pixel_central[data_set$label != 1], na.rm = TRUE)
n = length(pixel_central)
s = sd(pixel_central, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- media - z*(s/n)
lim_sup <- media + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
```
##c).

Para los tipos restantes de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 2:8){
  media = mean(pixel_central[data_set$label == i], na.rm = TRUE)
  n = length(pixel_central)
  s = sd(pixel_central, na.rm = TRUE)
  z = qnorm(0.025, lower.tail = FALSE)
  lim_inf <- media - z*(s/n)
  lim_sup <- media + z*(s/n)
  print(tejidos[i-1])
  d <- c(lim_inf , lim_sup)
  print(d)
}

```
#Punto 4.
##a).

Se tomar· una muestra de 200 im·genes aleatoriamente.

```{r}
muestra <- data_set[sample(nrow(data_set), 200),]
pixel_central = muestra$pixel0378
muestra
```

Para los tejidos con tumor, es decir para los cuales su label es igual a 1.

```{r}
media = mean(pixel_central[muestra$label == 1], na.rm = TRUE)
n = length(pixel_central)
s = sd(pixel_central, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- media - z*(s/n)
lim_sup <- media + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
```

Para los tejidos que no son tumor.

```{r}
media = mean(pixel_central[muestra$label != 1], na.rm = TRUE)
n = length(pixel_central)
s = sd(pixel_central, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- media - z*(s/n)
lim_sup <- media + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
```

Para los tipos restantes de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 2:8){
  media = mean(pixel_central[muestra$label == i], na.rm = TRUE)
  n = length(pixel_central)
  s = sd(pixel_central, na.rm = TRUE)
  z = qnorm(0.025, lower.tail = FALSE)
  lim_inf <- media - z*(s/n)
  lim_sup <- media + z*(s/n)
  print(tejidos[i-1])
  d <- c(lim_inf , lim_sup)
  print(d)
}

```

##b).

Se tomar· una muestra de 20 im·genes aleatoriamente.

```{r}
muestra <- data_set[sample(nrow(data_set), 20),]
pixel_central = muestra$pixel0378
muestra
```

Para los tejidos con tumor, es decir para los cuales su label es igual a 1.

```{r}
media = mean(pixel_central[muestra$label == 1], na.rm = TRUE)
n = length(pixel_central)
s = sd(pixel_central, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- media - z*(s/n)
lim_sup <- media + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
```

Para los tejidos que no son tumor.

```{r}
media = mean(pixel_central[muestra$label != 1], na.rm = TRUE)
n = length(pixel_central)
s = sd(pixel_central, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- media - z*(s/n)
lim_sup <- media + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
```

Para los tipos restantes de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 2:8){
  media = mean(pixel_central[muestra$label == i], na.rm = TRUE)
  n = length(pixel_central)
  s = sd(pixel_central, na.rm = TRUE)
  z = qnorm(0.025, lower.tail = FALSE)
  lim_inf <- media - z*(s/n)
  lim_sup <- media + z*(s/n)
  print(tejidos[i-1])
  d <- c(lim_inf , lim_sup)
  print(d)
}

```

##c).

Ahora generaremos 100 muestras aleatorias de 200 im·genes cada una.
Empecemos con los tejidos que tienen tumor, es decir, cuya label es 1.

```{r}
medias_100 = c(rep(0,100))
for(i in 1:100){
  muestra <- data_set[sample(nrow(data_set), 200),]
  pixel_central = muestra$pixel0378
  media = mean(pixel_central[muestra$label == 1], na.rm = TRUE)
  medias_100[i] = media 
}
n = length(medias_100)
miu = mean(medias_100, na.rm = TRUE)
s = sd(medias_100, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- miu - z*(s/n)
lim_sup <- miu + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
hist(medias_100,main = paste("Histograma de las medias de los tejidos con tumor"), xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
```

Ahora los tejidos sin tumor.

```{r}
medias_100 = c(rep(0,100))
for(i in 1:100){
  muestra <- data_set[sample(nrow(data_set), 200),]
  pixel_central = muestra$pixel0378
  media = mean(pixel_central[muestra$label != 1], na.rm = TRUE)
  medias_100[i] = media
}
n = length(medias_100)
miu = mean(medias_100, na.rm = TRUE)
s = sd(medias_100, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- miu - z*(s/n)
lim_sup <- miu + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
hist(medias_100,main = paste("Histograma de las medias de los tejidos sin tumor"), xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
```

Y finalmente para el resto de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 2:8){
  medias_100 = c(rep(0,100))
  for(j in 1:100){
    muestra <- data_set[sample(nrow(data_set), 200),]
    pixel_central = muestra$pixel0378
    media = mean(pixel_central[muestra$label == i], na.rm = TRUE)
    medias_100[j] = media 
  }
  n = length(medias_100)
  miu = mean(medias_100, na.rm = TRUE)
  s = sd(medias_100, na.rm = TRUE)
  z = qnorm(0.025, lower.tail = FALSE)
  lim_inf <- miu - z*(s/n)
  lim_sup <- miu + z*(s/n)
  print(paste("IC de ", tejidos[i-1]))
  d <- c(lim_inf , lim_sup)
  print(d)
  hist(medias_100,main = paste("Histograma de las medias de los tejidos ", tejidos[i-1]), xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
}

```

##d)


Ahora generaremos 100 muestras aleatorias de 20 im·genes cada una.
Empecemos con los tejidos que tienen tumor, es decir, cuya label es 1.

```{r}
medias_100 = c(rep(0,100))
for(i in 1:100){
  muestra <- data_set[sample(nrow(data_set), 20),]
  pixel_central = muestra$pixel0378
  media = mean(pixel_central[muestra$label == 1], na.rm = TRUE)
  medias_100[i] = media 
}
n = length(medias_100, na.rm = TRUE)
miu = mean(medias_100, na.rm = TRUE)
s = sd(medias_100)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- miu - z*(s/n)
lim_sup <- miu + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
hist(medias_100,main = paste("Histograma de las medias de los tejidos con tumor"), xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
```

Ahora los tejidos sin tumor.

```{r}
medias_100 = c(rep(0,100))
for(i in 1:100){
  muestra <- data_set[sample(nrow(data_set), 20),]
  pixel_central = muestra$pixel0378
  media = mean(pixel_central[muestra$label != 1], na.rm = TRUE)
  medias_100[i] = media 
}
n = length(medias_100)
miu = mean(medias_100, na.rm = TRUE)
s = sd(medias_100, na.rm = TRUE)
z = qnorm(0.025, lower.tail = FALSE)
lim_inf <- media - z*(s/n)
lim_sup <- media + z*(s/n)
print("IC:")
d <- c(lim_inf , lim_sup)
d
hist(medias_100,main = paste("Histograma de las medias de los tejidos sin tumor"), xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
```

Y finalmente para el resto de tejidos.

```{r}
tejidos <- c("Stroma","Complex","Lympho","Debris","Mucosa","Adipose","Empty")
for(i in 2:8){
  medias_100 = c(rep(0,100))
  for(j in 1:100){
    muestra <- data_set[sample(nrow(data_set), 20),]
    pixel_central = muestra$pixel0378
    media = mean(pixel_central[muestra$label == i], na.rm = TRUE)
    medias_100[j] = media 
  }
  n = length(medias_100)
  miu = mean(medias_100, na.rm = TRUE)
  s = sd(medias_100, na.rm = TRUE)
  z = qnorm(0.025, lower.tail = FALSE)
  lim_inf <- miu - z*(s/n)
  lim_sup <- miu + z*(s/n)
  print(paste("IC de ", tejidos[i-1]))
  d <- c(lim_inf , lim_sup)
  print(d)
  hist(medias_100,main = paste("Histograma de las medias de los tejidos ", tejidos[i-1]), xlab = "Intensidad", ylab = "Frecuencia", col = "Light Blue")
}

```

--